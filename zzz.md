いいね！ここまでで “CASE 強化” 系はやり切れたので、改めて**「仕様として“あるけど未実装”系」**を整理しておくね。重複は避けつつ、粒度は実装単位で分けてある。進める順のおすすめも最後に。

# 仕様として“あるけど未実装”系（現状まとめ）

## 型・リテラル

* 整数の種類拡張：`SINT, INT, DINT, LINT, USINT, UINT, UDINT, ULINT`
* ビット文字列型：`BYTE, WORD, DWORD, LWORD`
* 日時・時間型：`TIME, LTIME, DATE, TIME_OF_DAY (TOD), DATE_AND_TIME (DT)` とそのリテラル（例：`T#1s` など）と比較・加減
* 文字・ワイド文字：`CHAR, WCHAR`、`'A'` などの文字リテラル
* ワイド文字列：`WSTRING(n)`（型とリテラル）。今は STRING だけ
* 基数付き整数リテラル：`2#1010`, `16#FF` など
* 型付き数値リテラル：`INT#5`, `REAL#1.0`（いまは REAL/LREAL のみ型付きに対応）
* サブレンジ型：`INT (0..100)` のような上下限付き派生型（チェック含む）

## 演算子・式

* 整数/ビット列に対するビット演算の本実装：`AND/OR/XOR/NOT` を BOOL だけでなく整数・ビット列にも（現状 BOOL を主に扱い）
* シフト・ローテート：`SHL, SHR, ROL, ROR`
* 数学/文字列/日時の標準関数（`ABS, SQRT, LEN, CONCAT, LEFT, RIGHT, ADD(TIME, …)` など）※関数呼び出し基盤が必要
* ANY ファミリ対応：`ANY_INT / ANY_REAL / ANY_NUM / ANY_MAGNITUDE` に基づく演算子の型束縛・昇格（現状は INT↔REAL/LREAL の一部昇格のみ）

## 文字列

* `STRING(n)/WSTRING(n)` の**最大長チェック**（定数初期化やリテラル連結があれば静的に検出）
* 文字列演算の拡充：`=` `<` `<>` の他、ベンダ関数（`CONCAT` など）を関数コールとして扱う

## 配列・構造体・集成初期化

* 配列/構造体の**集成初期化**：`[1,2,3]`、`(x := 1, y := 2)` のような初期化子
* **コンパイル時計上チェック**：配列境界が定数でインデクスも定数のとき越境を静的検出
* 構造体/配列の**デフォルト初期化**（要設計）：全フィールド/要素の既定初期値を合成するかどうかの方針決め

## 列挙体

* **非修飾列挙子の許容**（`Red` だけで型が明確な文脈なら OK にする等）。曖昧解決やパーサの設計が要る
* 列挙子の**重複明示値**や範囲外値の扱い（今は基本チェックのみ／明示値付けは実装済）

## 文・宣言

* ループ制御・関数系キーワード：`EXIT`（ループ脱出）、`CONTINUE`（実装するなら）、`RETURN`（関数/FB対応時）
* 追加 VAR セクション：`VAR_INPUT, VAR_OUTPUT, VAR_IN_OUT, VAR_TEMP` 等
* **関数／関数ブロック／メソッド呼び出し**：呼び出し構文、実引数（位置/名前付き/既定値）、オーバーロード解決、`fb()` 呼び出し
* **明示的型変換関数**：`TO_INT`, `REAL_TO_LREAL` …（標準/ベンダ関数の一部）

## エラー回復・診断の充実

* すべての主要構文での `registerParseError`/`withRecovery` の適用範囲拡大（現状カバー済みの外側にも波及）
* CASE の**到達不能腕**検出（先ほどの提案は一旦見送り済）

---

# すぐ着手しやすい順（おすすめ）

1. **DONE 整数とビット列の型群（SINT〜LINT, BYTE〜LWORD）**
   　→ 演算子・昇格・リテラル基数やビット演算の布石にもなる。

2. **DONE 基数付き整数リテラル（2# / 16# …）**
   　→ 既存の `pInt` を拡張。型はまず `INT` に寄せ、後で桁幅に応じた型当てに発展可。

3. **DONE ビット演算の整数対応 & -シフト演算（SHL/SHR/ROL/ROR）-**
   　→ BOOL/整数/ビット列ごとの型規則を整える。優先順位は CODESYS に合わせる。

4. **DONE CHAR/WCHAR/WSTRING**
   　→ 既にエスケープ分岐の土台があるので導入しやすい。`$"`/`$'` の扱いを型で切り替え。

5. **DONE 配列・構造体の集成初期化**
   　→ パーサと定数性チェック（VAR CONSTANT での式許容範囲）を一段底上げ。

6. **日付/時間型とリテラル（TIME/TOD/DATE/DT/…）**
   　→ 比較・加減の最小対応。演算子の ANY_MAGNITUDE へ布石。

7. **関数呼び出しの最小実装**（ユーザー定義 or 組み込み 1〜2 個）
   　→ 以後の機能（`EXPT` 代替・文字列関数等）の足回りが揃う。

---

この中から、いまのコードベースに“きれいに足せる”ものを優先するなら、**(1) 整数/ビット列の型拡張**→**(2) 基数付きリテラル**→**(3) シフト/ビット演算**の三点がおすすめ。
次の一歩、どれからいく？
